# xx.js 更新日志

## 2025-05-26

1. 优化API风格自适应支持：
   - 自动检测并支持 /VXAPI 和 /api 两种API风格
   - 心跳包请求格式统一为 query string 参数传递
   - 消息发送统一使用 JSON 请求体格式
   - 完善API映射表，确保两种风格接口兼容

2. 拍一拍功能优化：
   - 增加机器人身份验证，只在机器人被拍时回复
   - 添加详细的日志输出，便于问题排查
   - 优化消息处理逻辑，提高稳定性

3. 消息发送格式规范化：
   - 统一使用 application/json 请求头
   - 规范化不同类型消息的参数结构
   - 优化错误处理和重试机制
   - 完善请求超时设置

4. 代码结构优化：
   - 重构API端点处理逻辑
   - 优化日志输出格式
   - 增强错误处理机制
   - 提升代码可维护性

## 2025-05-17

1. 拍一拍消息识别由 MsgType=10000 改为 MsgType=10002，严格对齐PAD协议。
2. 拍一拍自动回复逻辑重构，支持构造器配置所有类型（text、image、video、file、voice、emoticon、link、card等），内容可为文字、链接、base64等。
3. 拍一拍自动回复消息体构造与发送提取为独立函数 sendPatReply，主流程调用更清晰。
4. 视频、图片等类型自动判断链接/本地/64，统一转为base64后发送，视频自动提取封面。
5. 所有消息类型参数结构严格按PAD协议文档，支持链接、名片等新类型。
6. 代码结构优化，调试日志完善，便于排查和维护。

---

## xx适配器全部功能清单

- 支持 PAD 协议全类型消息发送与接收：
  - 文本、图片、视频、语音、文件、表情、链接、名片等
- 支持两种API风格（/VXAPI和/api）自动适配
- 图片/视频/文件/语音支持本地、网络链接、base64三种方式自动转换
- 视频消息自动提取首帧为封面（如无cover参数）
- 拍一拍消息智能识别与自定义类型自动回复：
  - 支持所有消息类型回复
  - 智能判断机器人身份，避免误触发
- 支持群聊@、撤回消息、自动撤回
- 详细调试日志输出，便于开发与排查
- 兼容Bncr平台无界数据结构，易于扩展
- 配置项灵活，支持：
  - 自定义机器人ID
  - 拍一拍回复类型与内容
  - 自动撤回时间
  - API风格自动适配
- 仅保留HTTP接口，简化部署与维护
- 代码结构清晰，易于二次开发 